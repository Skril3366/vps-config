# Grafana dashboard
{% if domain_name != "YOUR_DOMAIN_OR_IP" %}
grafana.{{ domain_name }} {
{% else %}
:3001 {
{% endif %}
    reverse_proxy 127.0.0.1:{{ grafana_port }}
}

# Prometheus metrics
{% if domain_name != "YOUR_DOMAIN_OR_IP" %}
prometheus.{{ domain_name }} {
{% else %}
:9091 {
{% endif %}
    reverse_proxy 127.0.0.1:{{ prometheus_port }}
}

# Loki logs
{% if domain_name != "YOUR_DOMAIN_OR_IP" %}
loki.{{ domain_name }} {
{% else %}
:3101 {
{% endif %}
    reverse_proxy 127.0.0.1:{{ loki_port }}
}

# Keycloak authentication
{% if domain_name != "YOUR_DOMAIN_OR_IP" %}
auth.{{ domain_name }} {
{% else %}
:8081 {
{% endif %}
    reverse_proxy 127.0.0.1:{{ keycloak_port }}
}

# Main domain - redirect to Grafana or serve a landing page
{% if domain_name != "YOUR_DOMAIN_OR_IP" %}
{{ domain_name }} {
{% else %}
:80 {
{% endif %}
    header Content-Type text/html
    respond `<!DOCTYPE html>
<html>
<head>
    <title>{{ domain_name }} - Monitoring Services</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 50px; background: #f5f5f5; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #333; text-align: center; }
        .services { list-style: none; padding: 0; }
        .services li { margin: 15px 0; }
        .services a { display: block; padding: 15px; background: #007bff; color: white; text-decoration: none; border-radius: 5px; text-align: center; }
        .services a:hover { background: #0056b3; }
        .note { margin-top: 20px; padding: 10px; background: #fff3cd; border-left: 4px solid #ffc107; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Welcome to {{ domain_name }}</h1>
        <p>Monitoring and observability services:</p>
        <ul class="services">
            <li><a href="https://auth.{{ domain_name }}">Keycloak - Authentication & Authorization</a></li>
            <li><a href="https://grafana.{{ domain_name }}">Grafana - Dashboards & Visualization</a></li>
            <li><a href="https://prometheus.{{ domain_name }}">Prometheus - Metrics & Monitoring</a></li>
            <li><a href="https://loki.{{ domain_name }}/metrics">Loki - Log Aggregation (Metrics)</a></li>
        </ul>
        <div class="note">
            <strong>Services:</strong> All monitoring services are secured with HTTPS and accessible via subdomains.
        </div>
    </div>
</body>
</html>`
}

# Add your custom services here
# Example:
# {% if domain_name != "YOUR_DOMAIN_OR_IP" %}
# app.{{ domain_name }} {
# {% else %}
# :8080 {
# {% endif %}
#     reverse_proxy localhost:8000
# }